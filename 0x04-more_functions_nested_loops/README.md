More functions, more nested loops
Lets get this
